<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Job Platform</title>
    <link th:replace="index::linkrel">
    <style>
        .user-table img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
        }
        .user-table .btn-profile {
            padding: 6px 12px;
            font-size: 14px;
        }
        .user-table th {
            font-weight: bold;
            font-size: 16px;
            background-color: #f8f9fa;
            border: none;
        }
        .user-table tbody tr:hover {
            background-color: #f4f4f4;
        }
        .user-table tbody tr td {
            border: none;
        }
        .user-table thead th,
        .user-table tbody tr td {
            vertical-align: middle;
            text-align: center;
        }
    </style>
</head>
<body>
<div th:fragment="content">
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo03" aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <a class="navbar-brand" th:href="@{/}">Job App Platform</a>

        <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
            <ul class="navbar-nav ml-auto mr-2">
                <li th:if="${#authorization.expression('isAnonymous()')}" style="margin-right: 10px"><a th:href="@{/register}"><span class="glyphicon glyphicon-user"></span> Sign Up</a></li>
                <li th:if="${#authorization.expression('isAnonymous()')}" style="margin-right: 10px"><a th:href="@{/login}"><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
                <li th:unless="${#authorization.expression('isAnonymous()')}" style="margin-right: 10px"><a th:href="@{/profile/posts}">My Posts</a></li>
                <li th:if="${#authorization.expression('hasRole(''ROLE_Employer'')')}" style="margin-right: 10px"><a th:href="@{/jobs}">Jobs</a></li>
                <li th:unless="${#authorization.expression('isAnonymous()')}" style="margin-right: 20px;margin-left:5px">
                    <a th:href="@{/notifications}">
                    <span class="position-relative">
                      <i class="fas fa-bell"></i> <!-- Notification icon from Font Awesome -->
                      <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-black" th:text="${profile?.notificationsNumber}">

                      </span>
                    </span>
                    </a>
                </li>
                <li th:unless="${#authorization.expression('isAnonymous()')}" style="margin-right: 10px"><a th:href="@{/profile/view/{username}(username=${#authentication.name})}">My Profile</a></li>
                <li th:unless="${#authorization.expression('isAnonymous()')}" style="margin-right: 10px" ><a th:href="@{/logout}"><span class="glyphicon glyphicon-log-in"></span> Logout</a></li>
            </ul>
        </div>
    </nav>
</div>
<div class="container mt-4">
    <form method="get" class="form-inline my-2 my-lg-0" th:action="@{/search}">
        <input class="form-control mr-sm-2" th:value="${searchButton}" name="searchButton" type="search" placeholder="Search" aria-label="Search" style="width: 90%;">
        <div class="input-group">
            <select class="form-select" name="searchKeyword" id="selectOptions" aria-label="Default select example" style="padding: 5px;margin: 0px 10px 0px 5px">
                <option selected th:value="${searchKeyword}">Select an option</option>
                <option value="Profile">Profile</option>
                <option value="Job">Job</option>

            </select>
        </div>
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button><br>
        <table class="table table-bordered user-table" th:if="${searchKeyword != null && searchKeyword == 'Profile'}" style="margin-top: 25px">
            <thead>
            <tr>
                <th>Image</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>View</th>
                <th>Follow</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="profile : ${searchedProfiles}">
                <td><img src="https://via.placeholder.com/150" alt="User Image"></td>
                <td th:text="${profile.firstName}"></td>
                <td th:text="${profile.lastName}"></td>
                <td>
                    <a th:href="@{/profile/view/{username}(username=${profile.getAppuser().getUsername()})}" class="btn btn-primary">View Profile</a>
                </td>
                <td>
                    <a th:if="${profile.isFollowedByLoggedInUser()}" th:href="@{/profile/{id}/follow(id=${profile.id})}">Unfollow</a>
                    <a th:unless="${profile.isFollowedByLoggedInUser()}" th:href="@{/profile/{id}/follow(id=${profile.id})}">Follow</a>
                </td>
            </tr>
            </tbody>
        </table>
        <table class="table table-bordered user-table" style="margin-top: 20px" th:if="${searchKeyword != null && searchKeyword == 'Job'}">
            <thead>
            <tr>
                <th>Title</th>
                <th>Location</th>
                <th>Created Date</th>
                <th>Expiration Date</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="job : ${searchedJobs}">
                <td th:text="${job.title}"></td>
                <td th:text="${job.location}"></td>
                <td th:text="${job.dateCreated}"></td>
                <td th:text="${job.expirationDate}"></td>
                <td>
                    <a class="btn btn-primary" style="color: white">View Job</a>
                </td>
            </tr>
            </tbody>
        </table>
        <div th:if="${searchKeyword != null && searchKeyword == 'Profile'}">
            <ul class="pagination" th:if="${searchedProfiles != null && searchedProfiles.totalPages > 0}">
                <li th:each="pageNumber: ${#numbers.sequence(0, searchedProfiles.totalPages - 1)}">
                    <input type="submit" class="page-link" name="page" th:value="${pageNumber + 1}">
                </li>
            </ul>
        </div>
        <div th:if="${searchKeyword != null && searchKeyword == 'Job'}">
            <ul class="pagination" th:if="${searchedJobs != null && searchedJobs.totalPages > 0}">
                <li th:each="pageNumber: ${#numbers.sequence(0, searchedJobs.totalPages - 1)}">
                    <input type="submit" class="page-link" name="page" th:value="${pageNumber + 1}">
                </li>
            </ul>
        </div>
    </form>
</div>
<th:block th:replace="index::scripts"></th:block>

</body>
</html>